### Задание 1. Анализ, идентификация проблем и решений, планирование

##### Существующие и потенциальные проблемные места:
1. отсутствуют логирование, мониторинг, которые помогают быстро выявлять и подсвечивать узкие места в системе
2. при поиске новых заказов операторами кэширование не используется. Операторы часто запрашивают одни и те же списки заказов, что делает постоянные обращения к базе данных излишними
3. расчёт стоимости изделий в MES выполняется синхронно, что замедляет процесс. Его можно ускорить, сделав асинхронным: создать очередь для заказов и несколько воркеров, которые будут обрабатывать их параллельно. Кроме того, стоимость рассчитывается заново для каждого изделия, даже если модели идентичны или схожи, что создаёт дополнительную нагрузку на систему MES
4. в MES одна база данных хранит как активные, так и завершённые заказы, что снижает производительность и возможность удобно масштабироваться и добавлять подходящее кеширование. И в итоге с ростом кол-ва данных поиск замедляется, тк единичный инстанс не справляется с большим объёмом запросов
5. система не поддерживает горизонтальное масштабирование и не использует централизованный оркестратор. Это снижает отказоустойчивость системы и ограничивает масштабируемость
6. удобного CI/CD нету, в release и production окружения всё релизится вручную, что замедляет выпуск новых версий и повышает риски из-за человеческого фактора
7. в периоды пиковой активности система перегружается, тк для внешнего API не настроена балансировка нагрузки и ограничение запросов
8. MES не имеет механизмов для регулировки скорости входящих запросов, или временной остановки поступления сообщений, что может приводить к сбоям и нестабильной работе системы при большом кол-ве запросов

##### Инициативы, которые необходимы для устранения нежелательных ситуаций (в порядке приоритета, от самой важной до менее приоритетной):
1. реализовать сбор и анализ логов с помощью ELK, настроить мониторинг и визуализацию метрик через Prometheus и Grafana. Создать алерты для критичных событий. Это сократит время диагностики, повысит стабильность и прозрачность работы системы. В первую очередь необходимо настроить логирование в местах, где заказы могут зависать/теряться: обработка создания и изменения статусов заказов в MES, запись в очередь в CRM, внутренние ошибки сервисов, ошибки API и ошибки при работе с БД. Для наиболее важных событий (например, замедление обработки заказов, снижение числа новых заказов или рост ошибок в сервисах) настроить алерты, чтобы оперативно уведомлять о проблемах. Тогда возможно будет удаваться исправить ошибку, даже до того как в саппорт обратная связь что что-то не работает
2. реализовать кэширование в MES для ускорения расчёта стоимости изделий и получения списка заказов. Перевести обработку заказов в MES на асинхронный режим
3. разделить горячие(активные) и холодные(архивные) данные в БД MES, например, с помощью партиционирования таблиц. Для горячих данных применить оптимизированные частичные индексы
4. внедрить шардирование и репликацию в БД MES
5. внедрить и настроить трассировку запросов(Jaeger)
6. переехать на Kubernetes для оркестрации, автоматического масштабирования, мониторинга состояния и восстановления в случае сбоев
7. реализовать механизм backpressure между CRM и MES, что поможет регулировать поток сообщений, избегая лишних перегрузок системы
8. использовать CI/CD инструменты(например, Jenkins) для автоматического деплоя на все окружения после успешного прохождения линтеров/автотестов, чтобы убрать ручные релизы
9. вынести API для внешних пользователей на отдельный endpoint, внедрить API Gateway для проксирования запросов и балансировки нагрузки

##### Ответы на вопросы:
- Какой вы видите целевую архитектуру через полгода?
   - через полгода разработчики должны иметь возможность в реальном времени отслеживать проблемные места системы и прогнозировать её рост на основе метрик. Система будет способна масштабироваться в ответ на растущие нагрузки, как по объёму данных, так и по количеству пользователей

- Если бы у вас была возможность выполнить только три пункта из списка инициатив в ближайшие полгода, что бы вы выбрали и почему? Не обязательно добавлять в список только эпики. Вы можете включить в план как крупные изменения, так и локальные задачи.
   1. реализовать логирование и мониторинг(ELK, Prometheus, Grafana, алерты), чтобы быстрее выявлять проблемы и подсвечивать узкие места в системе
   2. реализовать кэширования в MES, распараллелить вычисления стоимости(например, через воркеры), чтобы сделать более устойчивой систему для пиковых нагрузок
   3. внедрить API Gateway с балансировкой нагрузки и rate-limiting, чтобы снижать вероятность перегрузки системы и подготовиться к дальнейшему переезду на Kubernetes